2025-11-10 13:19:19,760 INFO worker loop starting poll=0.50s
2025-11-10 13:21:21,530 WARNING worker idle for 120.6s (no queued jobs found)
2025-11-10 13:23:21,585 WARNING worker idle for 120.1s (no queued jobs found)
2025-11-10 13:25:21,693 WARNING worker idle for 120.1s (no queued jobs found)
2025-11-10 13:27:22,154 WARNING worker idle for 120.4s (no queued jobs found)
2025-11-10 13:29:22,756 WARNING worker idle for 120.6s (no queued jobs found)
2025-11-10 13:31:23,064 WARNING worker idle for 120.3s (no queued jobs found)
2025-11-10 13:33:23,625 WARNING worker idle for 120.6s (no queued jobs found)
2025-11-10 13:35:24,149 WARNING worker idle for 120.5s (no queued jobs found)
2025-11-10 13:37:24,375 WARNING worker idle for 120.2s (no queued jobs found)
2025-11-10 13:39:24,915 WARNING worker idle for 120.5s (no queued jobs found)
2025-11-10 13:41:25,269 WARNING worker idle for 120.4s (no queued jobs found)
2025-11-10 13:43:25,288 WARNING worker idle for 120.0s (no queued jobs found)
2025-11-10 13:45:25,855 WARNING worker idle for 120.6s (no queued jobs found)
2025-11-10 13:47:26,088 WARNING worker idle for 120.2s (no queued jobs found)
2025-11-10 13:48:44,066 INFO worker claimed job id=d8522d35-33f4-492e-949f-c5d11359343f type=CHUNK_EMBED
2025-11-10 13:48:44,066 INFO [worker] CHUNK_EMBED start document_id=49b77523-176b-47c0-b84b-bbb888e0b359
2025-11-10 13:48:46,451 INFO [worker] enqueue job type=EXTRACT_NORMALIZE doc=49b77523-176b-47c0-b84b-bbb888e0b359 idem=extract::49b77523-176b-47c0-b84b-bbb888e0b359::v1
2025-11-10 13:48:46,451 INFO event=chunked props={'document_id': UUID('49b77523-176b-47c0-b84b-bbb888e0b359'), 'n': 31}
2025-11-10 13:48:46,490 INFO [worker] CHUNK_EMBED done document_id=49b77523-176b-47c0-b84b-bbb888e0b359 chunks=31
2025-11-10 13:48:46,563 INFO worker finished job id=d8522d35-33f4-492e-949f-c5d11359343f type=CHUNK_EMBED
2025-11-10 13:50:46,925 WARNING worker idle for 120.1s (no queued jobs found)
2025-11-10 13:52:47,088 WARNING worker idle for 120.2s (no queued jobs found)
2025-11-10 13:54:47,571 WARNING worker idle for 120.5s (no queued jobs found)
2025-11-10 13:56:47,751 WARNING worker idle for 120.2s (no queued jobs found)
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/pranjalsingh/Project Simple/backend/api/workers/runner.py", line 129, in <module>
    main()
    ~~~~^^
  File "/Users/pranjalsingh/Project Simple/backend/api/workers/runner.py", line 125, in main
    asyncio.run(run_worker_loop())
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/pranjalsingh/Project Simple/backend/api/workers/runner.py", line 91, in run_worker_loop
    job = await _claim_next_job(session)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/backend/api/workers/runner.py", line 34, in _claim_next_job
    res = await session.execute(q)
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/pranja  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/pranjalsingh/Project Simple/backend/api/workers/runner.py", line 129, in <module>
    main()
    ~~~~^^
  File "/Users/pranjalsingh/Project Simple/backend/api/workers/runner.py", line 125, in main
    asyncio.run(run_worker_loop())
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/pranjalsingh/Project Simple/backend/api/workers/runner.py", line 91, in run_worker_loop
    job = await _claim_next_job(session)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/backend/api/workers/runner.py", line 34, in _claim_next_job
    res = await session.execute(q)
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1345, in _checkout
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1342, in _checkout
    fairy._connection_record.get_connection()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 836, in get_connection
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 955, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2421, in connect
    return await connect_utils._connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<20 lines>...
    )
    ^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/asyncpg/connect_utils.py", line 1075, in _connect
    raise last_error or exceptions.TargetServerAttributeNotMatched(
    ...<2 lines>...
    )
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/asyncpg/connect_utils.py", line 1049, in _connect
    conn = await _connect_addr(
           ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/asyncpg/connect_utils.py", line 886, in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/asyncpg/connect_utils.py", line 931, in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
  File "/Users/pranjalsingh/Project Simple/.venv/lib/python3.13/site-packages/asyncpg/connect_utils.py", line 802, in _create_ssl_connection
    tr, pr = await loop.create_connection(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        host, port)
        ^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 1117, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        (host, port), family=family,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        type=socket.SOCK_STREAM, proto=proto, flags=flags, loop=self)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 1500, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                  proto=proto, flags=flags)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 939, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
        None, getaddr_func, host, port, family, type, proto, flags)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 977, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 8] nodename nor servname provided, or not known
  result = self.fn(*self.args, **self.kwargs)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 977, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 8] nodename nor servname provided, or not known
